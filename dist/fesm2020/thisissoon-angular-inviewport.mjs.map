{"version":3,"file":"thisissoon-angular-inviewport.mjs","sources":["../../src/app/window/window-token.ts","../../src/app/in-viewport/in-viewport.directive.ts","../../src/app/window/window-mock.ts","../../src/app/in-viewport/in-viewport.module.ts","../../src/thisissoon-angular-inviewport.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\n\nexport const WINDOW = new InjectionToken<Window>('WINDOW', {\n  providedIn: 'root',\n  factory: () => window,\n});\n","import {\n  Directive,\n  ElementRef,\n  HostBinding,\n  EventEmitter,\n  Output,\n  OnDestroy,\n  AfterViewInit,\n  Inject,\n  Input,\n  OnInit,\n} from '@angular/core';\nimport { WINDOW } from '../window/window-token';\n\n/**\n * A simple lightweight library for Angular with that detects when an\n * element is within the browsers viewport and adds a `in-viewport` or\n * `not-in-viewport` class to the element.\n *\n * @example\n * ```html\n * <p\n *  class=\"foo\"\n *  snInViewport\n *  (inViewportChange)=\"myEventHandler($event)\">\n *  Amet tempor excepteur occaecat nulla.\n * </p>\n * ```\n */\n// @dynamic\n@Directive({\n  selector: '[snInViewport]',\n  exportAs: 'snInViewport',\n})\nexport class InViewportDirective implements AfterViewInit, OnDestroy, OnInit {\n  private inViewport: boolean;\n  private hasIntersectionObserver: boolean;\n  @Input()\n  inViewportOptions: IntersectionObserverInit;\n  @Output()\n  inViewportChange = new EventEmitter<boolean>();\n  observer: IntersectionObserver;\n\n  @HostBinding('class.sn-viewport--in')\n  get isInViewport(): boolean {\n    return this.inViewport;\n  }\n\n  @HostBinding('class.sn-viewport--out')\n  get isNotInViewport(): boolean {\n    return !this.inViewport;\n  }\n\n  constructor(private el: ElementRef, @Inject(WINDOW) private window: Window) {\n    this.hasIntersectionObserver = this.intersectionObserverFeatureDetection();\n  }\n\n  ngOnInit() {\n    if (!this.hasIntersectionObserver) {\n      this.inViewport = true;\n      this.inViewportChange.emit(this.inViewport);\n    }\n  }\n\n  ngAfterViewInit() {\n    if (this.hasIntersectionObserver) {\n      const IntersectionObserver = this.window['IntersectionObserver'];\n      this.observer = new IntersectionObserver(\n        this.intersectionObserverCallback.bind(this),\n        this.inViewportOptions\n      );\n\n      this.observer.observe(this.el.nativeElement);\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.observer) {\n      this.observer.unobserve(this.el.nativeElement);\n    }\n  }\n\n  intersectionObserverCallback(entries: IntersectionObserverEntry[]) {\n    entries.forEach((entry) => {\n      if (this.inViewport === entry.isIntersecting) return;\n      this.inViewport = entry.isIntersecting;\n      this.inViewportChange.emit(this.inViewport);\n    });\n  }\n\n  private intersectionObserverFeatureDetection() {\n    // Exits early if all IntersectionObserver and IntersectionObserverEntry\n    // features are natively supported.\n    if (\n      'IntersectionObserver' in this.window &&\n      'IntersectionObserverEntry' in this.window\n    ) {\n      // Minimal polyfill for Edge 15's lack of `isIntersecting`\n      // See: https://github.com/w3c/IntersectionObserver/issues/211\n      if (\n        !(\n          'isIntersecting' in\n          this.window['IntersectionObserverEntry']['prototype']\n        )\n      ) {\n        Object.defineProperty(\n          this.window['IntersectionObserverEntry']['prototype'],\n          'isIntersecting',\n          {\n            get: function () {\n              return this.intersectionRatio > 0;\n            },\n          }\n        );\n      }\n      return true;\n    }\n    return false;\n  }\n}\n","export const WINDOW_MOCK_WITHOUT_INTERSECTION_OBSERVER = {\n  closed: null,\n  defaultStatus: null,\n  document: null,\n  frameElement: null,\n  frames: null,\n  history: null,\n  innerHeight: null,\n  innerWidth: null,\n  length: null,\n  localStorage: null,\n  location: null,\n  name: null,\n  navigator: null,\n  opener: null,\n  outerHeight: null,\n  outerWidth: null,\n  pageXOffset: null,\n  pageYOffset: null,\n  parent: null,\n  screen: null,\n  screenLeft: null,\n  screenTop: null,\n  screenX: null,\n  screenY: null,\n  sessionStorage: null,\n  scrollX: null,\n  scrollY: null,\n  self: null,\n  status: null,\n  top: null,\n  addEventListener: (...args) => null,\n  alert: (...args) => null,\n  atob: (...args) => null,\n  blur: (...args) => null,\n  btoa: (...args) => null,\n  clearInterval: (...args) => null,\n  clearTimeout: (...args) => null,\n  close: (...args) => null,\n  confirm: (...args) => null,\n  focus: (...args) => null,\n  getComputedStyle: (...args) => null,\n  getSelection: (...args) => null,\n  matchMedia: (...args) => null,\n  moveBy: (...args) => null,\n  moveTo: (...args) => null,\n  open: (...args) => null,\n  print: (...args) => null,\n  prompt: (...args) => null,\n  resizeBy: (...args) => null,\n  resizeTo: (...args) => null,\n  removeEventListener: (...args) => null,\n  scroll: (...args) => null,\n  scrollBy: (...args) => null,\n  scrollTo: (...args) => null,\n  setInterval: (...args) => null,\n  setTimeout: (...args) => null,\n  stop: (...args) => null,\n};\n\nexport const WINDOW_MOCK = {\n  ...WINDOW_MOCK_WITHOUT_INTERSECTION_OBSERVER,\n  IntersectionObserver: function (...args) {\n    this.observe = () => null;\n    this.unobserve = () => null;\n  },\n  IntersectionObserverEntry: class IntersectionObserverEntryMock {},\n};\n","import { NgModule, ModuleWithProviders } from '@angular/core';\n\nimport { InViewportDirective } from './in-viewport.directive';\nimport { WINDOW } from '../window/window-token';\nimport { WINDOW_MOCK } from '../window/window-mock';\n\n/**\n * A simple lightweight library for Angular with other dependencies\n * that detects when an element is within the browsers viewport and adds a\n * sn-viewport--in or sn-viewport--out class to the element.\n */\n@NgModule({\n  declarations: [InViewportDirective],\n  exports: [InViewportDirective],\n})\nexport class InViewportModule {\n  static forServer(): ModuleWithProviders<InViewportModule> {\n    return {\n      ngModule: InViewportModule,\n      providers: [{ provide: WINDOW, useValue: WINDOW_MOCK }],\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}